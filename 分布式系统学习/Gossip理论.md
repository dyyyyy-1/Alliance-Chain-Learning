# Gossip协议

## 六度分隔理论

1967年，哈佛大学的心理学教授Stanley Milgram想要描绘一个连结人与社区的人际连系网。做过一次连锁信实验，结果发现了“六度分隔”现象。简单地说：“你和任何一个陌生人之间所间隔的人不会超过六个，也就是说，最多通过六个人你就能够认识任何一个陌生人。

这个理论也被看做为Gossip 理论的雏形。

## Gossip的实现原理

在Gossip原理中，一个节点想要把内容分享给网络中的其他节点，于是该节点周期性的随机发送内容给其他节点，而其他节点收到信息以后同样会进行周期性的发送工作。
假设第一个周期中第一个节点随机往n个节点发送消息，在第二个周期时将会有n+1个节点继续向其他节点进行消息传播。

理论上，在最好的情况下，每个节点会不重复的向其他节点进行发送消息，但是在现实生活中并不会这样。

在现实生活中由于节点像其他节点发送的消息是无向的，经常会有重复发送的情况发生。所以在Gossip协议中是具备可扩展性的，增加节点其实并不会对传播周期影响太大。

## Gossip协议的特点

在Gossip协议中有以下几个特点

1. 去中心化与扩展性
  - 节点与节点之间不需要中心化的控制与调度，节点之间只需要根据一定的策略来与周围的节点进行资源交换
  - 节点增加或者减少并不会对整个系统造成明显的影响，便于灵活的更改网络规模
2. 容错性
  - 即使部分节点发生故障，由于消息传播时随机的，在一定的传播次数后依然可以在网络中传播出去
3. 信息传播效率快
  - 由于节点在网络中随机发送消息，使得只需要节点之间有少数节点互通就可以快速将消息传播至整个网络

## Gossip协议的缺点

尽管Gossip协议有如此之多的优点，但它依然存在一些问题，这可能会导致某些情况下出现错误

1. 传播时间不确定
  - Gossip协议传播速度很快，但是由于传播的随机性以及节点连接的数量以及网络环境等因素，我们不能保证消息会在什么时候被传播到目标节点，具备不确定性。
2. 一致性问题
  - 如果我们要求系统中保持消息的一致性，当我们使用Gossip协议的时候可能就无法达到强一致性的水平。由于传播的随机性，节点可能会在同一时间看到不同的消息状态。
3. 资源消耗
  - 尽管一个节点可能之和几个节点连通，但是如果我们是在大规模的网络中使用Gossip协议，这些资源交换量可能会叠加在一起，造成网络带宽和计算力的一个消耗。
4. 节点攻击
  - 比如最经典的拜占庭问题，当有节点恶意发布大量虚假消息时，系统有可能会做出错误的判断。



